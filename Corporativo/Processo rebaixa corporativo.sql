/*------------LISTANDO OS PRODUTOS----------------*/
SELECT CODPROD,
       DESCRICAO,
       CODFORNEC
  FROM PCPRODUT
 WHERE CODPROD IN (
    797800, 797804, 797802, 796055, 799815, 802956, 808030, 808029
);
/

/*----------------------------ESTOQUE E CUSTO NAS FILIAL 1,2,3,4,7----------------*/
SELECT *
  FROM (
    SELECT T.CODFILIAL,
           T.CODPROD,
           NVL (T.QTESTGER, 0) AS QTESTGER,
           NVL (T.VALORULTENT, 0) AS VALORULTENT,
           NVL (T.CUSTOFIN, 0) AS CUSTOFIN
      FROM PCEST T
     WHERE T.CODPROD IN (
        797800, 797804, 797802, 796055, 799815, 802956, 808030, 808029
    )
) PIVOT (
    SUM (QTESTGER)
QTESTGER, SUM (VALORULTENT) VALORULTENT, SUM (CUSTOFIN) CUSTOFIN
    FOR CODFILIAL
    IN (1, 2, 3, 4, 7)
)
 ORDER BY CODPROD;
/