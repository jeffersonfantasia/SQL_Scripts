/*------------ENCONTRANDO OS CODPROD DOS PRODUTOS----------------*/
SELECT CODFAB,
       CODPROD,
       DESCRICAO,
       IMPORTADO
  FROM PCPRODUT
 WHERE CODFAB IN (
    '1301050700045', '1001301400202', '1001301400204', '1201602900131', '1201602000190', '1201602900146', '1201602900143', '1201602900138'
    , '1201602900144', '1201602900140', '1201602900152', '1201602900134', '1201602900123', '1201602900142', '1201602000144', '1201602000188'
    , '1201602900136', '1201602900151', '1201602900148', '1301952200047', '1301952200054', '1301952200057', '1301952200055', '1301952200056'
);
/

/*----------------------------ESTOQUE E CUSTO NAS FILIAL 1,2,7----------------*/
SELECT *
  FROM (
    SELECT T.CODFILIAL,
           T.CODPROD,
           NVL (T.QTESTGER, 0) AS QTESTGER,
           NVL (T.VALORULTENT, 0) AS VALORULTENT,
           NVL (T.CUSTOFIN, 0) AS CUSTOFIN
      FROM PCEST T
     WHERE T.CODPROD IN (
        797800, 797804, 797802, 796055, 799815, 802956, 808030, 808029
    )
) PIVOT (
    SUM (QTESTGER)
QTESTGER, SUM (VALORULTENT) VALORULTENT, SUM (CUSTOFIN) CUSTOFIN
    FOR CODFILIAL
    IN (1, 2, 7)
)
 ORDER BY CODPROD;
/


/*-----------------------------------ANÁLISE DE PEÇAS VENDIDAS POR REDE DE CLIENTES OU CLIENTES----------------------------------*/
SELECT *
  FROM (
    SELECT M.CODPROD,
     /*C.CODREDE, */
           S.CODCLI,
           QT
      FROM PCMOV M,
           PCNFSAID S,
           PCCLIENT C
     WHERE M.NUMTRANSVENDA = S.NUMTRANSVENDA
       AND C.CODCLI = S.CODCLI
       AND S.CONDVENDA = 1
       AND S.DTSAIDA > TO_DATE ('01/01/2019', 'DD/MM/YYYY')
       AND M.CODPROD IN (
        803135, 803134, 803133, 803132, 802852, 804032, 806620
    )
) PIVOT (
    SUM (QT)
        /* FOR CODREDE IN (272, 254, 459, 285, 248, 384, 457, 455, 249, 300, 474, 599, 445, 583, 314, 584, 250, 588, 554, 429, 471, 415)*/
    FOR CODCLI
    IN (7354, 410, 386, 388, 4358, 7644, 8645, 7831)
)
 ORDER BY CODPROD;
/