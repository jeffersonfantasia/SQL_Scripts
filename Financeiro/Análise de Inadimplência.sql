SELECT T.DTEMISSAO,
       T.DTVENC,
       T.DTPAG,
       TO_CHAR(T.DTVENC, 'MM') AS MES_VENC,
       T.CODCLI,
       C.CLIENTE,
       C.CODREDE,
       R.DESCRICAO AS REDE,
       T.DUPLIC,
       T.PREST,
       T.VALOR,
       NVL(T.VPAGO, 0) AS VALOR_PAGO,
       NVL(T.TXPERM, 0) AS JUROS,
       (CASE
         WHEN DTPAG IS NULL THEN
          T.VALOR
         ELSE
          0
       END) AS EM_ABERTO,
       (CASE
         WHEN (T.DTVENC < TRUNC(SYSDATE) AND T.DTPAG IS NULL) THEN
          'VENCIDO'
         WHEN T.DTPAG IS NULL THEN
          'A VENCER'
         ELSE
          'PAGO'
       END) AS POSICAO,
       C.CODUSUR1,
       U.NOME
  FROM PCPREST T
  LEFT JOIN PCCLIENT C
    ON T.CODCLI = C.CODCLI
  LEFT JOIN PCREDECLIENTE R
    ON C.CODREDE = R.CODREDE
  LEFT JOIN PCUSUARI U
    ON T.CODUSUR = U.CODUSUR
 WHERE T.CODFILIAL = 2
   AND T.CODCOB = 'BK'
   AND T.DTCANCEL IS NULL
   AND T.DTEMISSAO BETWEEN TO_DATE('01/01/2019', 'DD/MM/YYYY') AND TO_DATE('08/04/2020', 'DD/MM/YYYY')
 ORDER BY T.DTVENC;