SELECT MAX (M.DTMOV) DTULTCOMPRA,
       M.CODPROD
  FROM PCMOV M
 WHERE M.CODFILIAL = 7
   AND M.CODFISCAL IN (
    1101, 1102, 1403, 2102, 2401, 2403, 1118, 1119, 1121, 2118, 2119, 2121, 1116, 1117, 2116, 2117
)
   AND M.DTCANCEL IS NULL
 GROUP BY M.CODPROD;
/